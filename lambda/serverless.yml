service: ChurchAppAPI

custom: ${file(config/config_dev.yml)}

provider:
  name: aws
  runtime: nodejs12.x

  stage: dev
  region: us-east-1

package:
  individually: true
  exclude:
    - config/**
    - EventCreate/**
    - EventViewAll/**
    - UserCreate/**
    - UserLogin/**

functions:
  UserCreate:
    handler: UserCreate/index.handler
    timeout: 1
    memorySize: 128
    package:
      include:
        - UserCreate/index.js
    layers:
      - arn:aws:lambda:us-east-1:935952531494:layer:node-pg:3
    events:
      - http:
          path: /user/create
          method: post
    environment:
      PGDATABASE: ${self:custom.PGDATABASE}
      PGHOST: ${self:custom.PGHOST}
      PGPASSWORD: ${self:custom.PGPASSWORD}
      PGPORT: ${self:custom.PGPORT}
      PGUSER: ${self:custom.PGUSER}

  UserRead:
    handler: UserRead/index.handler
    timeout: 1
    memorySize: 128
    package:
      include:
        - UserRead/index.js
    layers:
      - arn:aws:lambda:us-east-1:935952531494:layer:node-pg:3
    events:
      - http:
          path: /user/read/{username}
          method: get
          request:
            parameters:
              paths:
                username: true
    environment:
      PGDATABASE: ${self:custom.PGDATABASE}
      PGHOST: ${self:custom.PGHOST}
      PGPASSWORD: ${self:custom.PGPASSWORD}
      PGPORT: ${self:custom.PGPORT}
      PGUSER: ${self:custom.PGUSER}
